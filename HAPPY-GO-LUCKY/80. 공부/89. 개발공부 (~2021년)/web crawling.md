---
tags:
  - python
  - web-crawler
  - web-crawling
Created: Invalid date
Updated: Invalid date
---
selenium: http://selenium-python.readthedocs.io/installation.html

\# -*- coding:utf-8 -*-# python 소스 인코딩from selenium import webdriverfrom selenium.webdriver import Chrome, Remoteimport timeimport sysimport codecsimport csv  ##### http://selenium-python.readthedocs.io/navigating.html # for the first time, download the file (chromedriver.exe) from seleniumhq.org and put the file in the directory at this script. print 'Hello, World!' driver = NonedetailDriver = None sid = Noneurl = 'https://www.icin.or.kr/STAT/STAT_02_011.aspx?Idx=2&SearchKeyword=' if len(sys.argv) > 1:    sid = sys.argv[1]if len(sys.argv) > 2:    url = sys.argv[2]if sid is None:    print 'NEW BROWSER'    driver = Chrome()    print("python PythonApplication1.py %s %s" % (driver.session_id, driver.command_executor._url))    # Exit current session for next using. Always use this program by browser reusing.    sys.exit() print 'REUSE THE BROWSER'driver = Remote(command_executor=url, desired_capabilities={})# bypass a problem which opens a new browser. Close the new browser then assign the session id to current driver.driver.close()driver.session_id = sid filename_utf8 = Nonefilename_error = None # filename = Nonecsvfile_utf8 = Nonecsvfile_error = None def stringFormat(str):    try:        return str.strip().replace(",", ".").replace(u"

- ", "-") + "," except: return "string format error", sys.exc_info()[0] \# alter this values.count = 0limit = 84270while count < limit: # text = driver.find_element_by_xpath("//span[@id='ucOrg1_repeaterList_ctl01_lblNo']").text try: element = None if (count == 0 or ((count % 1000) == 0)): filename_utf8 = time.strftime("%Y%m%d-%H%M%S") + '_utf8.csv' filename_error = time.strftime("%Y%m%d-%H%M%S") + '_error.txt' csvfile_utf8 = codecs.open(filename_utf8, 'a', 'utf-8') csvfile_error = codecs.open(filename_error, 'a', 'utf-8') except: print "86: file open error", sys.exc_info()[0] # detail page num = 1 max_num = 11 while num < max_num: try: # row id extraStr = "" if num < 10: extraStr = "0" numStr = extraStr + str(num) # add real count in data totalRowNum = driver.find_element("xpath", "//span[@id='ucOrg1_repeaterList_ctl" + numStr + "_lblNo']").text resultStr = stringFormat(totalRowNum) # get href and go to detail page titleTdId = "//a[@id='ucOrg1_repeaterList_ctl" + numStr + "_hlcert']" detailRow = driver.find_element("xpath", titleTdId) detailLink = detailRow.get_attribute('href') detailTitle = detailRow.get_attribute("innerHTML") if detailDriver is None: detailDriver = Remote(command_executor=url, desired_capabilities={}) detailDriver.get(detailLink) tdList = detailDriver.find_elements("xpath", "//td[@class='list']") # read data for td in tdList: try: resultStr += stringFormat(td.text) except: print "127 error:", sys.exc_info()[0] csvfile_utf8.write(resultStr + "\n") num += 1 except Exception as error: num += 1 print "142: error message:", sys.exc_info()[0] detailDriver = Remote(command_executor=url, desired_capabilities={}) try: resultStr = stringFormat(totalRowNum) + stringFormat(detailTitle) + stringFormat('view error') + stringFormat(detailLink) + resultStr csvfile_error.write(resultStr + "\n") print "148: error resultStr:", resultStr except: print "150: error in error", sys.exc_info()[0] print "151: end" # - end while # go to next page pageTagList = driver.find_elements("xpath", "//span[@id='ucOrg1_phList']/a") for pageTag in pageTagList: try: img = pageTag.find_element("tag name", "img") src = img.get_attribute("src") if(src == "https://www.icin.or.kr/img/skin_01/btn_right_on.gif"): element = pageTag except: None if element is not None: # press '>' icon on the pageing. element.send_keys('\n') count = count + 1 print count else: sys.exit() \#end while